#!/bin/bash

# Add Mux Signing Keys to .env.local

SIGNING_KEY_ID="ejY4MOEjmxeYqti4v02eYg4esp2tJLYnmOBTa4RyxalU"
SIGNING_KEY="LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFb3dJQkFBS0NBUUVBcDhFZG1GaThmUXBtQ09YRWxXQ1Q2OXZaRGQxRzZKdXo0Rnk0VUlGb29kSHUrcDVPCitDbk5jdDIxT0dGcHRBVHlSMHh0R2R5NVA0NkJncXh3UnBOYjhpTktJOFd2QUhoaElCTzlzQUcwc2xpQmpic28KM2xrWlM1RUJCMTEwdldGb1MvNWJ2azk2TFZWWERmQ3lTdHBRWEVlZUlvYnd0TlhpZnB4eWQ0M1ZIeDRFVTMxZgpNSktDT2YzS0VLZVBOK3NqellHSzhQbkpWZGNsZExaeTl0aWRQUFFQZENxNnBuc0svQzc0aDYwNE1iZGdVUlFlCnNRYTErODh3VW1LdGpUK0QxZ3p6WDZQSTMvUitKNnh3NWlZZmt6WW45b1dWYzVTKy9HekR3Ly8wS2ZsY0xLZGIKeVRweUVVQnBIeG5LemhsQkdtdzlmYzBOVk1lWU5vRDA4LzFXcndJREFRQUJBb0lCQUJkaUdLSjdrcXZUK2J5NQpibDZyWU0yL3pqQnhETlBGU2JHaUFGZkp4THNkc2dsQmJOemUvWHpLbGxxZXRYeGxpTWRUSDJLN1VoL0tXT3pOCk90OCtPMzJlZy85RmdjQjMzSU5Rb25XNHRIdlJwaDYxUjhhVk5vSHRNSmxhdDdnNExqQzlsVmlMUFRWa0pSSXAKTldrRlVsaWRRUUtBdXhKY2twN2h2Q1pFWVJYZVFFS1d1Q04yR3UxUjdNWUpTeFVXQTRVTnhOLzZoYTFZWGNrRgp1R25lclo2aUxySXZLclhtTGwvL0tHMjBtNTlqUHcrUjhzOGU3Q1IwTk1qMlNxNWRZTmRZL2w5VGVIcHVtenFGCk9pdlVUUUo4VnJ0WEZMMlNSK2FrTWtrWTFpQnN0cXhJaVBCcnVxNXZWUmltcFdHN1BtMzQ3WXdpQ2dFaGRRV0kKa0NqN1lLa0NnWUVBMlJ1b3FXdS91NUEvc1k2S29VRm1icjZtcDl4M05weVp3Z081UWRsN2VqSjJ0OXRkOHd6bApaRzFkbmlDWnloM3JqOURJazFjbUZHZjEvVVJ2RmZ1YUc3OFRjUHh4SWgrUXFBMDVZdDZWTllUN2ozU1FnbFNCCnZtT3RKdTdPOFVZQ00yWmxBZnYxTVVjVC9jOXY3MU5FK1E0VCtPQllUa0hRR0F3aWROU2YwdmtDZ1lFQXhjNG0KWU55WU1pVVhxNk5FaHpmSmloNk4zSS8zVXdacVhnYk92RGlmbmxFNDFFNDFyZllRdmJ1cDlxTk1LeVNsaTRmcwpBcjBva3dYVEZXYWRyN3dnMFE5SmEvV3RRbzVVQXpWWURhc1gvMENHcnRlVEY3b2IvNmo1NEN5dXF0b1BGck1ICmVNRlBIN1UrZ3g5U0d2T3pZY1hBczdWSWNsVFo3bmR2cnM3N3VPY0NnWUVBdmJFUjYzMXVWNFlRY0tXM2NHK0EKL1MvczB1dW82WGxvU29FUVkzMlBDbFIvTCtNbU1nOUplamFvUGxvRHBQb0JjSFdlV2tZaHltQ1BLRXVidDV4TwpxUUdKRGdZekh2cHZYTFc1Tnk1OU5mYk1DU3B5ZkwwelkxTVozZE4zMG8wMXJRMUJJYnV3SHU4WWc0RzBMbW9WCjhIbWhiNmtzM3F0WUV6cSsvRTh1bVprQ2dZQkFaWlRwQStnb3F4ckJyaTJwTitoTkp4VllNU1o3eVNMbjZaOTAKZDVxL21BSEFYSlh0UkthK25sSC9FYnJDY1BQVU1UUU0wRGhkWlJBTGI1VDJtWEMxbnh4d0lWTit6NGRhWkF0KwpwNnp3VkxtRVFucUl4dlpHaldTTUx2L09iNTlwN0c4S1NTVFJWZGc4Si80NitBdjJVTU1qdm1rUGo4QkRlbTdKCm9ta2hFUUtCZ0NQM2lDc2Q2bUtlcjZyWXVibWFTdWdieHZJd3RQcDhvU290WDdjMVRKbWpOdU9GZldNSXI5KzAKWE8waGhrNlhFeEF3VnhOS2ROSGFmRG40VW5xNmJvdHN5b3A5ZE9KV3lSVkNBdGNZb0N6aDNrWVBxUFllSmR5ZQo1cHVqdnFoSzFacW9qM21iVG51RnZnSjdSU0MyVTFvdEdFRno0Z3J5dkpHYUUzTWdWQm8yCi0tLS0tRU5EIFJTQSBQUklWQVRFIEtFWS0tLS0tCg=="

echo "Adding Mux Signing Keys to .env.local..."

# Update or add MUX_SIGNING_KEY_ID
if grep -q "MUX_SIGNING_KEY_ID" .env.local 2>/dev/null; then
  sed -i '' "s|MUX_SIGNING_KEY_ID=.*|MUX_SIGNING_KEY_ID=$SIGNING_KEY_ID|" .env.local
  echo "âœ… Updated MUX_SIGNING_KEY_ID"
else
  echo "" >> .env.local
  echo "# Mux Video - Signing Keys" >> .env.local
  echo "MUX_SIGNING_KEY_ID=$SIGNING_KEY_ID" >> .env.local
  echo "âœ… Added MUX_SIGNING_KEY_ID"
fi

# Update or add MUX_SIGNING_KEY
if grep -q "MUX_SIGNING_KEY=" .env.local 2>/dev/null; then
  # Use a different delimiter to avoid issues with special chars
  sed -i '' "s|MUX_SIGNING_KEY=.*|MUX_SIGNING_KEY=$SIGNING_KEY|" .env.local
  echo "âœ… Updated MUX_SIGNING_KEY"
else
  echo "MUX_SIGNING_KEY=$SIGNING_KEY" >> .env.local
  echo "âœ… Added MUX_SIGNING_KEY"
fi

echo ""
echo "âœ… Mux Signing Keys added!"
echo ""
echo "ðŸŽ‰ Mux setup is now COMPLETE!"
echo ""
echo "Next steps:"
echo "1. Restart your dev server (Ctrl+C then 'pnpm dev')"
echo "2. Test video upload at http://localhost:3000/admin/lessons"
echo "3. Create/edit a lesson and upload a video"

